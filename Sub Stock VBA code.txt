Sub Stock()    'Variable declarations    Dim ws As Worksheet    Dim currStock As String    Dim volume As Double    Dim i As Double    Dim LastRow As Double    Dim sumTableRow As Integer    'open and close    Dim openPrice As Double    Dim closePrice As Double    Dim yearlyChange As Double    Dim percentChange As Double       For Each ws In Worksheets            ' init total        volume = 0        LastRow = ws.Cells(Rows.Count, 1).End(xlUp).Row        sumTableRow = 2                ws.Cells(1, 9).Value = "Ticker"        ws.Cells(1, 10).Value = "Yearly Change"        ws.Cells(1, 11).Value = "Percent Change"        ws.Cells(1, 12).Value = "volume"        ' Open/Close Prices        openPrice = ws.Cells(2, 3).Value                ' Loop through all stock purchases        For i = 2 To LastRow                    ' Add to the Stock Total            volume = volume + ws.Cells(i, 7).Value                    ' Check if we are still within the same stock ticker, if it is not...            If ws.Cells(i + 1, 1).Value <> ws.Cells(i, 1).Value Then                'Grab the closing price                closePrice = ws.Cells(i, 6).Value                                'Yearly Change                yearlyChange = closePrice - openPrice                                'Percent Change                ' deal with divide by 0                If openPrice = 0 Then                    percentChange = 0                Else:                    percentChange = 100 * (yearlyChange / openPrice)                End If                                ' Set the stock name                currStock = ws.Cells(i, 1).Value                                ' Print the Stock Ticker in the Summary Table                ws.Range("I" & sumTableRow).Value = currStock                                ' Print the Yearly Change to the Summary Table                ws.Range("J" & sumTableRow).Value = yearlyChange                                ' Conditional Color                If yearlyChange > 0 Then                    ws.Range("J" & sumTableRow).Interior.ColorIndex = 4                ElseIf yearlyChange < 0 Then                    ws.Range("J" & sumTableRow).Interior.ColorIndex = 3                Else                    ws.Range("J" & sumTableRow).Interior.ColorIndex = 2                End If                                ' Print the Yearly Change to the Summary Table                ws.Range("K" & sumTableRow).Value = percentChange                                ' Print the Stock Amount to the Summary Table                ws.Range("L" & sumTableRow).Value = volume                                ' Add one to the summary table row                sumTableRow = sumTableRow + 1                                ' Reset the Brand Total                volume = 0                openPrice = ws.Cells(i + 1, 3)            End If                Next i                'analysis summary report        Dim gtInc_Ticker As String        Dim gtDec_Ticker As String        Dim gtTotal_Ticker As String                        Dim gtInc As Double        Dim gtDec As Double        Dim gtTotal As Double        gtInc = 0        gtDec = 0        gtTotal = 0                ws.Range("P1").Value = "Ticker"        ws.Range("Q1").Value = "Value"        ws.Range("O2").Value = "Greatest %Increas"        ws.Range("O3").Value = "Greatest %Decrease"        ws.Range("O4").Value = "Greatest Total Volume"        For i = 2 To sumTableRow - 1            'scan summary report get great value                        'find great increase number             If ws.Cells(i, 11).Value > gtInc Then                gtInc = ws.Cells(i, 11).Value                gtInc_Ticker = ws.Cells(i, 9).Value             End If            'find great decrease number             If ws.Cells(i, 11).Value < gtDec Then                gtDec = ws.Cells(i, 11).Value                gtDec_Ticker = ws.Cells(i, 9).Value             End If            'find great volumn            If ws.Cells(i, 12).Value > gtTotal Then                gtTotal = ws.Cells(i, 12).Value                gtTotal_Ticker = ws.Cells(i, 9).Value             End If        Next i                'export result        ws.Range("P2").Value = gtInc_Ticker        ws.Range("P3").Value = gtDec_Ticker        ws.Range("P4").Value = gtTotal_Ticker        ws.Range("Q2").Value = gtInc        ws.Range("Q3").Value = gtDec        ws.Range("Q4").Value = gtTotal        Next ws    End Sub